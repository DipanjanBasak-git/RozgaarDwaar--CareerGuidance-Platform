<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https: data:; img-src 'self' https: data:; style-src 'self' 'unsafe-inline' https:; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; font-src 'self' https: data:; frame-ancestors 'none'; upgrade-insecure-requests">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - RozgaarDwaar</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Top Header Bar -->
    <div class="top-header">
        <div class="container">
            <div class="top-header-left">
                <i class="fas fa-flag"></i>
                <span>भारत सरकार / Government Of India</span>
            </div>
            <div class="top-header-right">
                <i class="fas fa-thumbs-up"></i>
                <i class="fas fa-print"></i>
                <select class="lang-select">
                    <option value="en">English</option>
                    <option value="hi">हिंदी</option>
                    <option value="bn">বাংলা</option>
                    <option value="mr">मराठी</option>
                    <option value="te">తెలుగు</option>
                    <option value="ta">தமிழ்</option>
                </select>
                <i class="fas fa-volume-up"></i>
                <div class="text-size">
                    <span>A-</span>
                    <span>A</span>
                    <span>A+</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Header -->
    <header class="main-header">
        <div class="container">
            <div class="header-left">
                <div class="ministry-logo">
                    <div class="ashoka-chakra">☸</div>
                    <div class="ministry-text">
                        <div>MINISTRY OF SKILL DEVELOPMENT & ENTREPRENEURSHIP</div>
                        <div>GOVERNMENT OF INDIA</div>
                    </div>
                </div>
                <div class="program-logo">
                    <div class="pm-logo">
                        <span class="p-letter">R</span>
                        <span class="m-letter">D</span>
                    </div>
                    <div class="program-text">
                        <div>RozgaarDwaar</div>
                        <div>EMPOWERING YOUTH</div>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <button class="btn-register">
                    <i class="fas fa-user-plus"></i>
                    Youth Registration
                </button>
                <button class="btn-login">
                    <i class="fas fa-sign-in-alt"></i>
                    Login
                </button>
                <div class="viksit-bharat">
                    <div class="viksit-text">विकसित भारत अभियान</div>
                    <div class="viksit-years">1947 TO 2047</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Bar -->
    <nav class="main-nav">
        <div class="container">
            <ul class="nav-list">
                <li class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>HOME</span>
                </li>
                <li class="nav-item dropdown">
                    <i class="fas fa-book"></i>
                    <span>GUIDANCE</span>
                    <i class="fas fa-chevron-down"></i>
                    <ul class="dropdown-menu">
                        <li><a href="guidance.html">Skill Gap Analysis</a></li>
                        <li><a href="guidance.html">Courses</a></li>
                        <li><a href="guidance.html">Certifications</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <i class="fas fa-video"></i>
                    <span>INTERVIEW PREP</span>
                </li>
                <li class="nav-item">
                    <i class="fas fa-chart-bar"></i>
                    <span>ANALYTICS</span>
                </li>
                <li class="nav-item">
                    <i class="fas fa-handshake"></i>
                    <span>SCHEMES</span>
                </li>
                <li class="nav-item dropdown">
                    <i class="fas fa-headset"></i>
                    <span>SUPPORT</span>
                    <i class="fas fa-chevron-down"></i>
                    <ul class="dropdown-menu">
                        <li><a href="#">Call Center</a></li>
                        <li><a href="#">Track Request</a></li>
                        <li><a href="#">Raise Request</a></li>
                    </ul>
                </li>
                <li class="nav-item active">
                    <i class="fas fa-user"></i>
                    <span>PROFILE</span>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Profile Header -->
        <section class="profile-header">
            <div class="container">
                <div class="profile-info">
                    <div class="profile-avatar">
                        <img src="https://via.placeholder.com/150/FF6B35/FFFFFF?text=RK" alt="Profile Picture" id="profileImage">
                        <button class="btn-edit-avatar" onclick="changeProfilePicture()">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                    <div class="profile-details">
                        <h1 id="userName">Rajesh Kumar</h1>
                        <p class="profile-title" id="userAspiration">Software Developer</p>
                        <p class="profile-location">
                            <i class="fas fa-map-marker-alt"></i>
                            Delhi, India
                        </p>
                        <div class="profile-stats">
                            <div class="stat">
                                <span class="stat-number" id="userLevel">3</span>
                                <span class="stat-label">Level</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number" id="userPoints">1,250</span>
                                <span class="stat-label">Points</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number" id="userTypeLabel">Student</span>
                                <span class="stat-label">User Type</span>
                            </div>
                        </div>
                    </div>
                    <div class="profile-actions">
                        <button class="btn-primary" onclick="editProfile()">
                            <i class="fas fa-edit"></i>
                            Edit Profile
                        </button>
                        <button class="btn-secondary" onclick="downloadResume()">
                            <i class="fas fa-download"></i>
                            Download Resume
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Profile Tabs -->
        <section class="profile-tabs">
            <div class="container">
                <div class="tab-navigation">
                    <button class="tab-btn active" data-tab="overview">Overview</button>
                    <button class="tab-btn" data-tab="badges">Badges</button>
                    <button class="tab-btn" data-tab="resume">Resume</button>
                    <button class="tab-btn" data-tab="feedback">Feedback</button>
                    <button class="tab-btn" data-tab="recommended">Recommended</button>
                    <button class="tab-btn" data-tab="settings">Settings</button>
                </div>
            </div>
        </section>

        <!-- Tab Content -->
        <section class="tab-content">
            <div class="container">
                <!-- Overview Tab -->
                <div class="tab-panel active" id="overview">
                    <div class="overview-grid">
                        <!-- Personal Information -->
                        <div class="info-card">
                            <h3><i class="fas fa-user"></i> Personal Information</h3>
                            <div class="info-list">
                                <div class="info-item">
                                    <span class="info-label">Full Name:</span>
                                    <span class="info-value" id="fullName">Rajesh Kumar</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Email:</span>
                                    <span class="info-value" id="userEmail">rajesh.kumar@email.com</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Phone:</span>
                                    <span class="info-value" id="userPhone">+91 98765 43210</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Date of Birth:</span>
                                    <span class="info-value">15th March, 2000</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Gender:</span>
                                    <span class="info-value">Male</span>
                                </div>
                            </div>
                        </div>

                        <!-- Education -->
                        <div class="info-card">
                            <h3><i class="fas fa-graduation-cap"></i> Education</h3>
                            <div class="education-item">
                                <div class="education-header">
                                    <h4 id="userEducation">B.Tech Computer Science</h4>
                                    <span class="education-year">2022</span>
                                </div>
                                <p class="education-institution">Delhi Technological University</p>
                                <p class="education-grade">CGPA: 8.5/10</p>
                            </div>
                        </div>

                        <!-- Skills -->
                        <div class="info-card">
                            <h3><i class="fas fa-cogs"></i> Skills</h3>
                            <div class="skills-list" id="skillsList">
                                <span class="skill-tag">JavaScript</span>
                                <span class="skill-tag">React</span>
                                <span class="skill-tag">Node.js</span>
                                <span class="skill-tag">Python</span>
                                <span class="skill-tag">SQL</span>
                                <span class="skill-tag">Git</span>
                            </div>
                        </div>

                        <!-- Recent Activity -->
                        <div class="info-card">
                            <h3><i class="fas fa-history"></i> Recent Activity</h3>
                            <div class="activity-list">
                                <div class="activity-item">
                                    <div class="activity-icon">
                                        <i class="fas fa-briefcase"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Applied for Software Developer at TechCorp</div>
                                        <div class="activity-time">2 hours ago</div>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-icon">
                                        <i class="fas fa-certificate"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Completed JavaScript Fundamentals Course</div>
                                        <div class="activity-time">1 day ago</div>
                                    </div>
                                </div>
                                <div class="activity-item">
                                    <div class="activity-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-title">Earned "Skill Enhancer" Badge</div>
                                        <div class="activity-time">3 days ago</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Badges Tab -->
                <div class="tab-panel" id="badges">
                    <div class="badges-section">
                        <h2 class="section-title">
                            <span class="title-line"></span>
                            Your Achievements
                            <span class="title-line"></span>
                        </h2>
                        <div class="badges-grid" id="badgesGrid">
                            <!-- Badges will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Resume Tab -->
                <div class="tab-panel" id="resume">
                    <div class="resume-section">
                        <div class="resume-header">
                            <h2>Resume Management</h2>
                            <button class="btn-primary" onclick="uploadNewResume()">
                                <i class="fas fa-upload"></i>
                                Upload New Resume
                            </button>
                        </div>
                        
                        <div class="resume-status">
                            <div class="resume-status-card">
                                <div class="status-icon">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="status-content">
                                    <h3>Current Resume</h3>
                                    <p>Resume uploaded and analyzed</p>
                                    <div class="ats-score-display">
                                        <span class="score-label">ATS Score:</span>
                                        <span class="score-value">85%</span>
                                    </div>
                                </div>
                                <div class="status-actions">
                                    <button class="btn-secondary" onclick="viewResume()">
                                        <i class="fas fa-eye"></i>
                                        View
                                    </button>
                                    <button class="btn-secondary" onclick="downloadResume()">
                                        <i class="fas fa-download"></i>
                                        Download
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="resume-recommendations">
                            <h3>Resume Recommendations</h3>
                            <div class="recommendations-list">
                                <div class="recommendation-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Add more relevant keywords from job descriptions</span>
                                </div>
                                <div class="recommendation-item">
                                    <i class="fas fa-check-circle"></i>
                                    <span>Include quantifiable achievements</span>
                                </div>
                                <div class="recommendation-item">
                                    <i class="fas fa-times-circle"></i>
                                    <span>Optimize formatting for ATS systems</span>
                                </div>
                                <div class="recommendation-item">
                                    <i class="fas fa-times-circle"></i>
                                    <span>Add skills section with industry-standard terms</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feedback Tab -->
                <div class="tab-panel" id="feedback">
                    <div class="feedback-section">
                        <h2 class="section-title">
                            <span class="title-line"></span>
                            Feedback & Reviews
                            <span class="title-line"></span>
                        </h2>
                        
                        <div class="feedback-stats">
                            <div class="feedback-stat">
                                <div class="stat-number">4.8</div>
                                <div class="stat-label">Average Rating</div>
                            </div>
                            <div class="feedback-stat">
                                <div class="stat-number">24</div>
                                <div class="stat-label">Total Reviews</div>
                            </div>
                            <div class="feedback-stat">
                                <div class="stat-number">18</div>
                                <div class="stat-label">Positive</div>
                            </div>
                        </div>

                        <div class="feedback-list">
                            <div class="feedback-item">
                                <div class="feedback-header">
                                    <div class="reviewer-info">
                                        <img src="https://via.placeholder.com/40/667eea/FFFFFF?text=AM" alt="Reviewer">
                                        <div class="reviewer-details">
                                            <h4>Amit Singh</h4>
                                            <p>Senior Developer at Infosys</p>
                                        </div>
                                    </div>
                                    <div class="rating">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </div>
                                </div>
                                <div class="feedback-content">
                                    <p>"Rajesh is a talented developer with strong problem-solving skills. His communication is excellent and he's always willing to help team members."</p>
                                </div>
                                <div class="feedback-date">2 days ago</div>
                            </div>

                            <div class="feedback-item">
                                <div class="feedback-header">
                                    <div class="reviewer-info">
                                        <img src="https://via.placeholder.com/40/43e97b/FFFFFF?text=PS" alt="Reviewer">
                                        <div class="reviewer-details">
                                            <h4>Priya Sharma</h4>
                                            <p>Project Manager at TechCorp</p>
                                        </div>
                                    </div>
                                    <div class="rating">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="far fa-star"></i>
                                    </div>
                                </div>
                                <div class="feedback-content">
                                    <p>"Great team player with solid technical skills. Rajesh consistently delivers quality work and meets deadlines."</p>
                                </div>
                                <div class="feedback-date">1 week ago</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recommended Jobs (before Settings) -->
                <div class="tab-panel" id="recommended">
                    <div class="badges-section">
                        <h2 class="section-title">
                            <span class="title-line"></span>
                            Recommended Jobs
                            <span class="title-line"></span>
                        </h2>
                        <div id="recommendedJobsGrid" class="find-jobs-grid"></div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div class="tab-panel" id="settings">
                    <div class="settings-section">
                        <h2 class="section-title">
                            <span class="title-line"></span>
                            Account Settings
                            <span class="title-line"></span>
                        </h2>
                        
                        <div class="settings-grid">
                            <div class="settings-card">
                                <h3><i class="fas fa-user-cog"></i> Profile Settings</h3>
                                <div class="setting-item">
                                    <label>Email Notifications</label>
                                    <input type="checkbox" checked>
                                </div>
                                <div class="setting-item">
                                    <label>SMS Notifications</label>
                                    <input type="checkbox">
                                </div>
                                <div class="setting-item">
                                    <label>Job Alerts</label>
                                    <input type="checkbox" checked>
                                </div>
                            </div>

                            <div class="settings-card">
                                <h3><i class="fas fa-shield-alt"></i> Privacy Settings</h3>
                                <div class="setting-item">
                                    <label>Profile Visibility</label>
                                    <select>
                                        <option value="public">Public</option>
                                        <option value="private">Private</option>
                                        <option value="connections">Connections Only</option>
                                    </select>
                                </div>
                                <div class="setting-item">
                                    <label>Show Contact Information</label>
                                    <input type="checkbox" checked>
                                </div>
                            </div>

                            <div class="settings-card">
                                <h3><i class="fas fa-key"></i> Security</h3>
                                <div class="setting-item">
                                    <label>Change Password</label>
                                    <button class="btn-secondary">Change</button>
                                </div>
                                <div class="setting-item">
                                    <label>Two-Factor Authentication</label>
                                    <input type="checkbox">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logos">
                        <div class="ministry-logo-footer">
                            <div class="ashoka-chakra">☸</div>
                            <div class="ministry-text">
                                <div>MINISTRY OF SKILL DEVELOPMENT & ENTREPRENEURSHIP</div>
                                <div>GOVERNMENT OF INDIA</div>
                            </div>
                        </div>
                    </div>
                    <div class="social-media">
                        <h4>Social Media</h4>
                        <div class="social-icons">
                            <i class="fab fa-youtube"></i>
                            <i class="fab fa-instagram"></i>
                            <i class="fab fa-linkedin"></i>
                            <i class="fab fa-twitter"></i>
                        </div>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Get to Know</h4>
                    <ul>
                        <li><a href="#">Partner Companies</a></li>
                        <li><a href="#">Guidelines</a></li>
                        <li><a href="#">FAQs</a></li>
                        <li><a href="#">Manuals</a></li>
                        <li><a href="#">Videos</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Us</h4>
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>A Wing, 5th Floor, Shastri Bhawan, Dr Rajendra Prasad Rd, New Delhi-110001</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>rozgaardwaar@msde.gov.in</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>1800 11 6090</span>
                        </div>
                    </div>
                </div>
                <div class="footer-section">
                    <h4>Download Mobile App</h4>
                    <p>Click the button below to download the app or scan the QR code with your phone.</p>
                    <button class="btn-play-store">
                        <i class="fab fa-google-play"></i>
                        GET IT ON Google Play
                    </button>
                    <div class="qr-code">
                        <div class="qr-placeholder">QR Code</div>
                    </div>
                </div>
                <div class="footer-section">
                    <div class="site-info">
                        <div class="build-version">Build Version: 1756988512377</div>
                        <div class="visitor-count">
                            <div class="visitor-number">4,13,48,891</div>
                            <div class="visitor-label">Total Visitors</div>
                        </div>
                        <div class="site-ownership">This site is owned by Ministry of Skill Development & Entrepreneurship.</div>
                        <div class="copyright">© 2024 RozgaarDwaar, All Rights Reserved.</div>
                        <div class="tech-collab">Technical collaboration with BISAG-N.</div>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Chatbot Widget -->
    <div class="chatbot-widget" id="chatbotWidget">
        <div class="chatbot-icon">
            <i class="fas fa-robot"></i>
        </div>
        <div class="chatbot-bubble">Hi! I'm Udyog Sathi. How can I help you today?</div>
    </div>

    <!-- Chatbot Modal -->
    <div class="chatbot-modal" id="chatbotModal">
        <div class="chatbot-header">
            <div class="chatbot-title">
                <i class="fas fa-robot"></i>
                Udyog Sathi
            </div>
            <button class="chatbot-close" id="chatbotClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="chatbot-messages" id="chatbotMessages">
            <div class="message bot-message">
                <div class="message-content">
                    Hello! I'm Udyog Sathi, your career assistant. How can I help you today?
                </div>
                <div class="message-time">Just now</div>
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="chatbotInput" placeholder="Type your message...">
            <button id="chatbotSend">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script src="data/mockData.js"></script>
    <script src="js/main.js"></script>
    <script src="js/chatbot.js"></script>
    <script>
        // Profile page specific JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            initializeProfilePage();
        });

        function initializeProfilePage() {
            // Initialize tab functionality
            initializeTabs();
            
            // Load user data
            loadUserData();
            
            // Load badges
            loadBadges();

            // Build recommended jobs once profile available
            renderRecommendedJobs();
        }

        function initializeTabs() {
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabPanels = document.querySelectorAll('.tab-panel');

            tabBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');
                    
                    // Remove active class from all tabs and panels
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabPanels.forEach(p => p.classList.remove('active'));
                    
                    // Add active class to clicked tab and corresponding panel
                    this.classList.add('active');
                    document.getElementById(targetTab).classList.add('active');
                });
            });
        }

        function loadUserData() {
            const stored = localStorage.getItem('rd_user_profile');
            const storedProfile = stored ? JSON.parse(stored) : null;
            let user = null;
            if (storedProfile) {
                user = {
                    name: storedProfile.name || 'User',
                    email: storedProfile.email || '',
                    phone: storedProfile.phone || '',
                    level: 1,
                    points: 0,
                    skills: storedProfile.skills || [],
                    education: storedProfile.education || '',
                    aspiration: storedProfile.aspiration || ''
                };
            } else if (window.mockData && window.mockData.users) {
                user = window.mockData.users[0];
            }

            if (user) {
                document.getElementById('userName').textContent = user.name;
                document.getElementById('fullName').textContent = user.name;
                document.getElementById('userEmail').textContent = user.email || '';
                document.getElementById('userPhone').textContent = user.phone || '';
                document.getElementById('userLevel').textContent = user.level || 1;
                document.getElementById('userPoints').textContent = (user.points || 0).toLocaleString();
                document.getElementById('userEducation').textContent = user.education || '';
                document.getElementById('userAspiration').textContent = user.aspiration || '';
                const typeEl = document.getElementById('userTypeLabel');
                if (typeEl) typeEl.textContent = (storedProfile && storedProfile.userType) ? storedProfile.userType : 'Student';

                const skillsList = document.getElementById('skillsList');
                skillsList.innerHTML = '';
                (user.skills || []).forEach(skill => {
                    const skillTag = document.createElement('span');
                    skillTag.className = 'skill-tag';
                    skillTag.textContent = skill;
                    skillsList.appendChild(skillTag);
                });
            }
        }

        function renderRecommendedJobs(){
            const grid = document.getElementById('recommendedJobsGrid');
            if (!grid) return;
            const stored = localStorage.getItem('rd_user_profile');
            const profile = stored ? JSON.parse(stored) : null;
            const aspiration = (profile && profile.aspiration ? profile.aspiration.toLowerCase() : '');
            const skillSet = new Set((profile && Array.isArray(profile.skills) ? profile.skills : []).map(s=>String(s).toLowerCase()));
            const jobs = (window.mockData && Array.isArray(window.mockData.jobs)) ? window.mockData.jobs : [];
            // Score jobs based on matches in title/description and skills
            const scored = jobs.map(job => {
                let score = 0;
                const hay = (job.title + ' ' + job.description + ' ' + (job.skills||[]).join(' ')).toLowerCase();
                if (aspiration) {
                    aspiration.split(/\s+/).forEach(k=>{ if (k && hay.includes(k)) score += 2; });
                }
                (job.skills||[]).forEach(s=>{ if (skillSet.has(String(s).toLowerCase())) score += 3; });
                return { job, score };
            }).filter(x=>x.score > 0);
            // Fallback: if nothing matched, show a few recent jobs
            const top = (scored.length ? scored.sort((a,b)=>b.score-a.score).slice(0,6).map(x=>x.job) : jobs.slice(0,6));
            if (!top || top.length === 0) {
                grid.innerHTML = '<div style="padding:20px;color:#666;">No recommendations available. Update your aspiration and skills to get better matches.</div>';
                return;
            }
            grid.innerHTML = top.map(job => `
                <div class="job-card">
                    <div class="job-header">
                        <h4>${job.title}</h4>
                        <span class="job-company">${job.company}</span>
                    </div>
                    <div class="job-details">
                        <span class="job-location"><i class=\"fas fa-map-marker-alt\"></i> ${job.location}</span>
                        <span class="job-type">${job.type}</span>
                    </div>
                    <div class="skills-list" style="margin:10px 0 0 0;display:flex;flex-wrap:wrap;gap:8px;">
                        ${(job.skills || []).slice(0,6).map(s=>`<span class='skill-tag'>${s}</span>`).join('')}
                    </div>
                    <div class="job-actions">
                        <a class="btn-action" href="${job.applicationUrl || ('https://example.com/apply/'+job.id)}" target="_blank" rel="noopener">Application Link</a>
                    </div>
                </div>
            `).join('');
        }

        function loadBadges() {
            if (window.mockData && window.mockData.badges) {
                const badgesGrid = document.getElementById('badgesGrid');
                const user = window.mockData.users[0];
                
                badgesGrid.innerHTML = '';
                
                window.mockData.badges.forEach(badge => {
                    const badgeCard = document.createElement('div');
                    badgeCard.className = 'badge-card';
                    
                    const isEarned = user.badges.includes(badge.id);
                    
                    badgeCard.innerHTML = `
                        <div class="badge-icon ${isEarned ? 'earned' : 'locked'}">
                            <i class="${badge.icon}"></i>
                        </div>
                        <div class="badge-info">
                            <h4>${badge.name}</h4>
                            <p>${badge.description}</p>
                            <div class="badge-points">${badge.points} points</div>
                        </div>
                        <div class="badge-status">
                            ${isEarned ? '<i class="fas fa-check-circle"></i>' : '<i class="fas fa-lock"></i>'}
                        </div>
                    `;
                    
                    badgesGrid.appendChild(badgeCard);
                });
            }
        }

        function editProfile() {
            const stored = localStorage.getItem('rd_user_profile');
            const profile = stored ? JSON.parse(stored) : { name:'', email:'', phone:'', education:'', location:'', aspiration:'', skills:[] };
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Edit Profile</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group"><label>Name</label><input id="ep_name" type="text" value="${profile.name||''}"></div>
                        <div class="form-group"><label>Email</label><input id="ep_email" type="email" value="${profile.email||''}"></div>
                        <div class="form-group"><label>Phone</label><input id="ep_phone" type="tel" value="${profile.phone||''}"></div>
                        <div class="form-group"><label>Education</label><input id="ep_edu" type="text" value="${profile.education||''}"></div>
                        <div class="form-group"><label>Location</label><input id="ep_loc" type="text" value="${profile.location||''}"></div>
                        <div class="form-group"><label>Aspiration</label><input id="ep_asp" type="text" value="${profile.aspiration||''}"></div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary modal-close">Cancel</button>
                        <button class="btn-primary" id="ep_save">Save</button>
                    </div>
                </div>`;
            document.body.appendChild(modal);
            const close = () => document.body.contains(modal) && document.body.removeChild(modal);
            modal.querySelectorAll('.modal-close').forEach(b=>b.addEventListener('click', close));
            modal.addEventListener('click', e=>{ if(e.target===modal) close(); });
            modal.querySelector('#ep_save').addEventListener('click', ()=>{
                const updated = {
                    name: document.getElementById('ep_name').value,
                    email: document.getElementById('ep_email').value,
                    phone: document.getElementById('ep_phone').value,
                    education: document.getElementById('ep_edu').value,
                    location: document.getElementById('ep_loc').value,
                    aspiration: document.getElementById('ep_asp').value,
                    skills: Array.isArray(profile.skills)? profile.skills : []
                };
                localStorage.setItem('rd_user_profile', JSON.stringify(updated));
                // Reflect changes on page immediately
                loadUserData();
                // Notify others (analytics)
                window.dispatchEvent(new CustomEvent('profileUpdated', { detail: updated }));
                showNotification('Profile updated successfully.', 'success');
                close();
            });
        }

        function changeProfilePicture() {
            showNotification('Profile picture change feature coming soon!', 'info');
        }

        function downloadResume() {
            showNotification('Resume download started!', 'success');
        }

        function uploadNewResume() {
            // Use the existing resume upload functionality from main.js
            if (window.showResumeUploadModal) {
                window.showResumeUploadModal();
            } else {
                showNotification('Resume upload feature coming soon!', 'info');
            }
        }

        function viewResume() {
            showNotification('Opening resume viewer...', 'info');
        }
    </script>
</body>
</html>
